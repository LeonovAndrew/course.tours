## üè¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏ (Customer Company)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
–•—Ä–∞–Ω–µ–Ω–∏–µ **—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π (—à–∫–æ–ª). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- –ù–∞–ª–æ–≥–æ–≤–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ (VAT)
- –ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ì–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–∞—Ö

### –¢–∞–±–ª–∏—Ü–∞: `so_customer_company`

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è:
| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|-------------|----------|
| `customer_id` | INT | –î–∞ | –°–≤—è–∑—å —Å –æ—Å–Ω–æ–≤–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º |
| `type_id` | INT | –ù–µ—Ç | –¢–∏–ø –∫–æ–º–ø–∞–Ω–∏–∏ (–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, IT –∏ —Ç.–¥.) |
| `name` | VARCHAR(100) | –î–∞ | –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ |
| `vat_number` | VARCHAR(100) | –ù–µ—Ç | –ù–æ–º–µ—Ä –ù–î–°/–Ω–∞–ª–æ–≥–∞ |
| `website` | VARCHAR(255) | –ù–µ—Ç | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–∞–π—Ç |

#### –ê–¥—Ä–µ—Å–Ω—ã–µ –ø–æ–ª—è:
| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|-------------|----------|
| `country_id` | INT | –î–∞ | –°—Ç—Ä–∞–Ω–∞ (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫) |
| `zone_id` | INT | –ù–µ—Ç | –†–µ–≥–∏–æ–Ω/—à—Ç–∞—Ç (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫) |
| `zone_name` | VARCHAR(150) | –ù–µ—Ç | –†–µ–≥–∏–æ–Ω (—Ä—É—á–Ω–æ–π –≤–≤–æ–¥) |
| `address_1` | VARCHAR(255) | –î–∞ | –£–ª–∏—Ü–∞, –¥–æ–º, –æ—Ñ–∏—Å |
| `address_2` | VARCHAR(255) | –ù–µ—Ç | –î–æ–ø. –∞–¥—Ä–µ—Å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |
| `city` | VARCHAR(255) | –î–∞ | –ì–æ—Ä–æ–¥ |
| `zip_code` | VARCHAR(10) | –î–∞ | –ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å |

#### –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –ø–æ–ª—è:
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `phone` | VARCHAR(32) | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω |
| `fax` | VARCHAR(32) | –§–∞–∫—Å (–µ—Å–ª–∏ –µ—Å—Ç—å) |

### –°–≤—è–∑–∏:

#### 1. **–¢–∏–ø –∫–æ–º–ø–∞–Ω–∏–∏ (CompanyType):**
```php
'type' => [self::BELONGS_TO, CompanyType::class, 'type_id']
```
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –æ—Ç—Ä–∞—Å–ª–µ–π (–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, IT, –∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥ –∏ —Ç.–¥.)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

#### 2. –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:+
```php
'country' => [self::BELONGS_TO, Country::class, 'country_id']
'zone'    => [self::BELONGS_TO, Zone::class, 'zone_id']
```
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Å—Ç—Ä–∞–Ω –∏ —Ä–µ–≥–∏–æ–Ω–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π

#### 3. –í–ª–∞–¥–µ–ª–µ—Ü:

```php
'customer' => [self::BELONGS_TO, Customer::class, 'customer_id']
```
- –°–≤—è–∑—å 1:1 —Å –æ—Å–Ω–æ–≤–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º
- –¢–æ–ª—å–∫–æ —à–∫–æ–ª—ã (group_id = 5) –∏–º–µ—é—Ç –∫–æ–º–ø–∞–Ω–∏—é

### –í–∞–ª–∏–¥–∞—Ü–∏—è:

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:
```php
['name, country_id, address_1, city, zip_code', 'required', 'on' => 'register']
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤:
```php
['website', 'url']                    // –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL
['phone, fax', 'match', 'pattern' => '/[0-9\s\-]+/'] // –¢–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã –∏ –¥–µ—Ñ–∏—Å—ã
['country_id, zone_id', 'numerical', 'min' => 1]     // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ ID
```
### –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
#### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —à–∫–æ–ª—ã:

```php
// GuestController::actionRegister()
if ($companyRequired) {
$company->attributes = request()->getPost($company->getModelName(), []);
$company->customer_id = $model->customer_id;
$company->save();
}
```
#### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è:
- –ß–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —à–∫–æ–ª—ã
- –î–ª—è –Ω–∞–ª–æ–≥–æ–≤–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

#### 3. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∞–¥—Ä–µ—Å–∞
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ VAT –Ω–æ–º–µ—Ä–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞/—Å–∞–π—Ç–∞

### –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
#### –í—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏:
```php
// –°—Ç—Ä–∞–Ω—ã (–≤—Å–µ)
public function getCountriesDropDown()

// –†–µ–≥–∏–æ–Ω—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω—ã)
public function getZonesDropDown()
```
### AJAX –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤:

```javascript
// –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω—ã
$('#CustomerCompany_country_id').change(function() {
    $.get(createUrl('account/zones_by_country'), {
        country_id: $(this).val()
    }, function(zones) {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤
    });
});
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
#### 1. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞:
- –ï—Å–ª–∏ —Ä–µ–≥–∏–æ–Ω–∞ –Ω–µ—Ç –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ ‚Üí –ø–æ–ª–µ zone_name
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —Ä–µ–≥–∏–æ–Ω–∞–º–∏

#### 2. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞:
- address_1 - –æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- address_2 - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–∞–ª–æ–≥–∞–º–∏:
- vat_number –¥–ª—è –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –Ω–∞–ª–æ–≥–æ–≤—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

#### 4. –î–ª—è —Ä–∞–∑–Ω—ã—Ö —é—Ä–∏—Å–¥–∏–∫—Ü–∏–π:
- –†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –ø–æ—á—Ç–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
- –†–∞–∑–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ VAT
- –†–∞–∑–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
#### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —à–∫–æ–ª—ã:

```php
$company = new CustomerCompany('register');
$company->attributes = [
    'name' => 'Dubai International Language School',
    'type_id' => 1, // Education
    'country_id' => 229, // UAE
    'zone_id' => 123, // Dubai
    'address_1' => 'Sheikh Zayed Road, Business Bay',
    'city' => 'Dubai',
    'zip_code' => '12345',
    'phone' => '+97142212345',
    'website' => 'https://dubailanguage.com',
    'vat_number' => 'VAT123456789' // –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è
];
$company->customer_id = $customer->customer_id;
$company->save();
```

### –í–∞–∂–Ω–æ—Å—Ç—å –¥–ª—è –±–∏–∑–Ω–µ—Å–∞:
#### 1. –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è:
- –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- –ù–∞–ª–æ–≥–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

#### 2. –î–æ–≤–µ—Ä–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤:
- –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏
- –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–º–∏–¥–∂

#### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏:
- –ù–∞–ª–æ–≥–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã (VAT)
- –í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–æ–≤
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∞–¥—Ä–µ—Å–∞ –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π